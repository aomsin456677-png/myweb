<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MemoryGram Pro</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>

/* ================= GLOBAL ================= */

*{margin:0;padding:0;box-sizing:border-box;font-family:'Prompt',sans-serif;}

body{
background:#0f0f14;
color:white;
transition:0.4s;
}

.hidden{display:none;}

button{
padding:8px 15px;
border:none;
border-radius:20px;
background:linear-gradient(90deg,#6a5cff,#00f2ff);
color:white;
cursor:pointer;
}

input{
padding:8px;
border-radius:10px;
border:none;
margin:5px 0;
width:100%;
}

/* ================= AUTH ================= */

.auth{
display:flex;
justify-content:center;
align-items:center;
height:100vh;
background:linear-gradient(45deg,#141e30,#243b55);
}

.auth-box{
background:rgba(255,255,255,0.1);
padding:40px;
border-radius:20px;
width:320px;
backdrop-filter:blur(20px);
}

.auth-box h2{text-align:center;margin-bottom:15px;}

/* ================= APP ================= */

header{
display:flex;
justify-content:space-between;
padding:15px 30px;
background:rgba(255,255,255,0.05);
backdrop-filter:blur(20px);
position:sticky;
top:0;
}

.container{
max-width:700px;
margin:20px auto;
padding:0 15px;
}

.post{
background:rgba(255,255,255,0.05);
margin-bottom:20px;
border-radius:20px;
overflow:hidden;
}

.post img{
width:100%;
max-height:400px;
object-fit:cover;
}

.post-content{
padding:10px 15px;
}

.story-bar{
display:flex;
gap:10px;
overflow-x:auto;
margin-bottom:20px;
}

.story{
width:70px;height:70px;border-radius:50%;
border:3px solid #6a5cff;
overflow:hidden;
cursor:pointer;
}

.story img{
width:100%;height:100%;object-fit:cover;
}

.profile{
text-align:center;
margin-bottom:20px;
}

.profile img{
width:100px;height:100px;border-radius:50%;
object-fit:cover;
margin-bottom:10px;
}

.comment{
font-size:14px;
opacity:0.8;
}

.chat-box{
position:fixed;
bottom:0;right:0;
width:300px;
height:400px;
background:#111;
border-radius:20px 20px 0 0;
display:none;
flex-direction:column;
}

.chat-messages{
flex:1;
overflow-y:auto;
padding:10px;
}

.notification{
position:fixed;
top:10px;right:10px;
background:red;
padding:10px;
border-radius:10px;
display:none;
}

.dark{background:#000;}

</style>
</head>
<body>

<!-- AUTH PAGE -->
<div id="authPage" class="auth">
<div class="auth-box">
<h2>MemoryGram</h2>
<input type="text" id="username" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
<input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
<button onclick="register()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
<button onclick="login()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
</div>
</div>

<!-- APP -->
<div id="app" class="hidden">

<header>
<h3>MemoryGram</h3>
<div>
<button onclick="toggleDark()">üåô</button>
<button onclick="logout()">‡∏≠‡∏≠‡∏Å</button>
</div>
</header>

<div class="container">

<div class="profile" id="profile"></div>

<div class="story-bar" id="stories"></div>

<div>
<h4>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå</h4>
<input type="file" id="postImg">
<input type="text" id="caption" placeholder="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏Ñ‡∏õ‡∏ä‡∏±‡∏ô">
<button onclick="addPost()">‡πÇ‡∏û‡∏™‡∏ï‡πå</button>
</div>

<hr style="margin:20px 0;">

<div id="feed"></div>

</div>

</div>

<div class="chat-box" id="chatBox">
<div class="chat-messages" id="chatMessages"></div>
<input type="text" id="chatInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...">
<button onclick="sendMessage()">‡∏™‡πà‡∏á</button>
</div>

<div class="notification" id="notif">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà!</div>

<script>

/* ================= DATA ================= */

let users = JSON.parse(localStorage.getItem("users")) || [];
let currentUser = JSON.parse(localStorage.getItem("currentUser")) || null;
let posts = JSON.parse(localStorage.getItem("posts")) || [];
let stories = JSON.parse(localStorage.getItem("stories")) || [];
let chats = JSON.parse(localStorage.getItem("chats")) || [];

function saveAll(){
localStorage.setItem("users",JSON.stringify(users));
localStorage.setItem("currentUser",JSON.stringify(currentUser));
localStorage.setItem("posts",JSON.stringify(posts));
localStorage.setItem("stories",JSON.stringify(stories));
localStorage.setItem("chats",JSON.stringify(chats));
}

/* ================= AUTH ================= */

function register(){
let u=document.getElementById("username").value;
let p=document.getElementById("password").value;
if(!u||!p) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
users.push({username:u,password:p,followers:0});
saveAll();
alert("‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
}

function login(){
let u=document.getElementById("username").value;
let p=document.getElementById("password").value;
let user=users.find(x=>x.username===u && x.password===p);
if(user){
currentUser=user;
saveAll();
startApp();
}else{
alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
}
}

function logout(){
currentUser=null;
saveAll();
location.reload();
}

/* ================= APP ================= */

function startApp(){
document.getElementById("authPage").classList.add("hidden");
document.getElementById("app").classList.remove("hidden");
renderProfile();
renderPosts();
renderStories();
}

if(currentUser) startApp();

/* ================= PROFILE ================= */

function renderProfile(){
document.getElementById("profile").innerHTML=
`
<img src="https://i.pravatar.cc/150?u=${currentUser.username}">
<h3>${currentUser.username}</h3>
<p>‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°: ${currentUser.followers}</p>
<button onclick="openChat()">‡πÅ‡∏ä‡∏ó</button>
`;
}

/* ================= POSTS ================= */

function addPost(){
let file=document.getElementById("postImg").files[0];
let caption=document.getElementById("caption").value;
if(!file) return;
let reader=new FileReader();
reader.onload=function(e){
posts.unshift({
user:currentUser.username,
img:e.target.result,
caption:caption,
likes:0,
comments:[]
});
stories.unshift(e.target.result);
saveAll();
renderPosts();
renderStories();
showNotif();
}
reader.readAsDataURL(file);
}

function renderPosts(){
let feed=document.getElementById("feed");
feed.innerHTML="";
posts.forEach((p,i)=>{
feed.innerHTML+=`
<div class="post">
<img src="${p.img}">
<div class="post-content">
<b>${p.user}</b>
<p>${p.caption}</p>
<p onclick="like(${i})">‚ù§Ô∏è ${p.likes}</p>
<div>
${p.comments.map(c=>`<div class="comment">üí¨ ${c}</div>`).join("")}
</div>
<input type="text" id="c${i}" placeholder="‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå">
<button onclick="comment(${i})">‡∏™‡πà‡∏á</button>
</div>
</div>
`;
});
}

function like(i){
posts[i].likes++;
saveAll();
renderPosts();
}

function comment(i){
let input=document.getElementById("c"+i);
posts[i].comments.push(input.value);
saveAll();
renderPosts();
}

/* ================= STORIES ================= */

function renderStories(){
let s=document.getElementById("stories");
s.innerHTML="";
stories.forEach((img,i)=>{
s.innerHTML+=`
<div class="story" onclick="viewStory('${img}')">
<img src="${img}">
</div>
`;
});
}

function viewStory(src){
let w=window.open("");
w.document.write(`<img src="${src}" style="width:100%">`);
}

/* ================= CHAT ================= */

function openChat(){
document.getElementById("chatBox").style.display="flex";
}

function sendMessage(){
let msg=document.getElementById("chatInput").value;
chats.push({user:currentUser.username,message:msg});
saveAll();
renderChat();
}

function renderChat(){
let box=document.getElementById("chatMessages");
box.innerHTML="";
chats.forEach(c=>{
box.innerHTML+=`<div><b>${c.user}:</b> ${c.message}</div>`;
});
}

/* ================= NOTIFICATION ================= */

function showNotif(){
let n=document.getElementById("notif");
n.style.display="block";
setTimeout(()=>n.style.display="none",3000);
}

/* ================= DARK ================= */

function toggleDark(){
document.body.classList.toggle("dark");
}

</script>
</body>
</html>
