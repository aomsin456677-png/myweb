<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>GoodNotes Web Pro</title>

<style>
body{
margin:0;
overflow:hidden;
font-family:Arial;
background:#f0f0f0;
}

#toolbar{
position:fixed;
top:0;
left:0;
right:0;
height:70px;
background:white;
display:flex;
align-items:center;
gap:10px;
padding:10px;
box-shadow:0 2px 5px rgba(0,0,0,0.2);
z-index:10;
flex-wrap:wrap;
}

button{
padding:8px 12px;
border:none;
border-radius:8px;
background:#4f46e5;
color:white;
font-size:14px;
}

button:hover{
opacity:0.8;
}

input[type="color"],
input[type="range"],
select{
height:35px;
}

canvas{
position:absolute;
top:70px;
left:0;
background:white;
}

.dark{
background:#111;
color:white;
}
</style>
</head>
<body>

<div id="toolbar">
<button onclick="setTool('pen')">‚úè ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤</button>
<button onclick="setTool('highlighter')">üñç ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå</button>
<button onclick="setTool('eraser')">üßΩ ‡∏¢‡∏≤‡∏á‡∏•‡∏ö</button>
<button onclick="undo()">‚Ü© Undo</button>
<button onclick="redo()">‚Ü™ Redo</button>
<button onclick="addPage()">‚ûï ‡∏´‡∏ô‡πâ‡∏≤</button>
<button onclick="saveImage()">üíæ Export</button>
<button onclick="toggleDark()">üåô</button>

<input type="color" id="colorPicker" value="#000000">
<input type="range" id="size" min="1" max="25" value="4">

<select id="paperType" onchange="changePaper()">
<option value="plain">‡πÄ‡∏õ‡∏•‡πà‡∏≤</option>
<option value="line">‡πÄ‡∏™‡πâ‡∏ô</option>
<option value="grid">‡∏ï‡∏≤‡∏£‡∏≤‡∏á</option>
</select>

<input type="file" id="imgUpload" accept="image/*">
</div>

<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let pages = [];
let currentPage = 0;
let drawing = false;
let tool = "pen";
let history = [];
let redoStack = [];

function resizeCanvas(){
canvas.width = window.innerWidth;
canvas.height = window.innerHeight - 70;
renderPage();
}
resizeCanvas();
window.onresize = resizeCanvas;

function saveState(){
history.push(canvas.toDataURL());
if(history.length>50) history.shift();
}

function undo(){
if(history.length>0){
redoStack.push(canvas.toDataURL());
let img = new Image();
img.src = history.pop();
img.onload=()=>ctx.drawImage(img,0,0);
}
}

function redo(){
if(redoStack.length>0){
let img = new Image();
img.src = redoStack.pop();
img.onload=()=>ctx.drawImage(img,0,0);
}
}

canvas.addEventListener("pointerdown", e=>{
drawing = true;
ctx.beginPath();
draw(e);
});

canvas.addEventListener("pointermove", draw);
canvas.addEventListener("pointerup", ()=>{
drawing=false;
saveState();
});
canvas.addEventListener("pointerout", ()=>drawing=false);

function draw(e){
if(!drawing) return;

let rect = canvas.getBoundingClientRect();
let x = e.clientX - rect.left;
let y = e.clientY - rect.top;

ctx.lineCap="round";
ctx.lineJoin="round";

if(tool==="eraser"){
ctx.globalCompositeOperation="destination-out";
ctx.lineWidth=20;
}else{
ctx.globalCompositeOperation="source-over";
ctx.strokeStyle=document.getElementById("colorPicker").value;
ctx.lineWidth=document.getElementById("size").value*(e.pressure||1);
if(tool==="highlighter"){
ctx.globalAlpha=0.3;
}else{
ctx.globalAlpha=1;
}
}

ctx.lineTo(x,y);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(x,y);
}

function setTool(t){
tool=t;
}

function addPage(){
pages.push(canvas.toDataURL());
currentPage = pages.length;
ctx.clearRect(0,0,canvas.width,canvas.height);
}

function renderPage(){
ctx.clearRect(0,0,canvas.width,canvas.height);
if(pages[currentPage]){
let img=new Image();
img.src=pages[currentPage];
img.onload=()=>ctx.drawImage(img,0,0);
}
changePaper();
}

function saveImage(){
let link=document.createElement("a");
link.download="note.png";
link.href=canvas.toDataURL();
link.click();
}

function toggleDark(){
document.body.classList.toggle("dark");
}

function changePaper(){
let type=document.getElementById("paperType").value;
if(type==="line"){
ctx.strokeStyle="#ddd";
for(let i=20;i<canvas.height;i+=30){
ctx.beginPath();
ctx.moveTo(0,i);
ctx.lineTo(canvas.width,i);
ctx.stroke();
}
}
if(type==="grid"){
ctx.strokeStyle="#eee";
for(let i=20;i<canvas.height;i+=25){
ctx.beginPath();
ctx.moveTo(0,i);
ctx.lineTo(canvas.width,i);
ctx.stroke();
}
for(let j=20;j<canvas.width;j+=25){
ctx.beginPath();
ctx.moveTo(j,0);
ctx.lineTo(j,canvas.height);
ctx.stroke();
}
}
}

document.getElementById("imgUpload").addEventListener("change",function(e){
let file=e.target.files[0];
let reader=new FileReader();
reader.onload=function(evt){
let img=new Image();
img.src=evt.target.result;
img.onload=()=>ctx.drawImage(img,50,50,200,200);
}
reader.readAsDataURL(file);
});
</script>

</body>
</html>
