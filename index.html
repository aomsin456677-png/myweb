<div id="app"></div>

<style>
@import url('https://fonts.googleapis.com/css2?family=Prompt:wght@400;600;700&display=swap');

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Prompt',sans-serif;
}

body{
  background:linear-gradient(135deg,#141e30,#243b55);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  color:white;
}

.container{
  width:95%;
  max-width:1100px;
  text-align:center;
}

.glass{
  background:rgba(255,255,255,0.1);
  backdrop-filter:blur(20px);
  padding:30px;
  border-radius:25px;
}

button{
  padding:8px 15px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  margin:5px;
  font-weight:600;
}

.blue{background:#0072ff;color:white;}
.green{background:#2ecc71;color:white;}
.red{background:#e74c3c;color:white;}
.gray{background:#95a5a6;color:white;}

input, textarea{
  width:100%;
  padding:8px;
  border-radius:8px;
  border:none;
  margin:6px 0;
}

textarea{
  height:100px;
  resize:none;
}

table{
  width:100%;
  background:white;
  color:#333;
  border-collapse:collapse;
  font-size:13px;
}

th, td{
  padding:8px;
  border-bottom:1px solid #ddd;
}

th{
  background:#0072ff;
  color:white;
}

/* üî• ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ */
.status-approved{
  background:#2ecc71;
  color:white;
  font-weight:700;
}

.status-rejected{
  background:#e74c3c;
  color:white;
  font-weight:700;
}

.status-pending{
  background:#f1c40f;
  color:black;
  font-weight:600;
}
</style>

<script>
const ADMIN_USERNAME = "AOMSIN";
const ADMIN_PASSWORD = "451122";

let currentUserPhone = "";

// ---------- ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å ----------
function showHome(){
  document.getElementById("app").innerHTML = `
  <div class="container">
    <div class="glass">
      <h1>‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ô‡∏¥‡∏Ñ‡∏°</h1>
      <button class="blue" onclick="showUserLogin()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πà‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</button>
      <br>
      <button class="blue" onclick="showAdminLogin()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
    </div>
  </div>`;
}

// ---------- ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ----------
function showUserLogin(){
  document.getElementById("app").innerHTML = `
  <div class="container">
    <div class="glass">
      <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</h2>
      <input id="phone" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">
      <button class="blue" onclick="loginUser()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
      <button class="gray" onclick="showHome()">‡∏Å‡∏•‡∏±‡∏ö</button>
    </div>
  </div>`;
}

function loginUser(){
  let phone = document.getElementById("phone").value;
  if(!phone){ alert("‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏Å‡πà‡∏≠‡∏ô"); return; }
  currentUserPhone = phone;
  showUserDashboard();
}

// ---------- ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ----------
function showUserDashboard(){
  let data = JSON.parse(localStorage.getItem("problems")) || [];
  let myProblems = data.filter(p=>p.phone===currentUserPhone);

  let rows = "";

  if(myProblems.length===0){
    rows = `<tr><td colspan="5">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</td></tr>`;
  }else{
    myProblems.forEach((item,index)=>{

      let displayStatus = "‡∏£‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô";
      let statusClass = "status-pending";

      if(item.status === "‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°"){
        displayStatus = "‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß";
        statusClass = "status-approved";
      }else if(item.status === "‡πÑ‡∏°‡πà‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°"){
        displayStatus = "‡πÑ‡∏°‡πà‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°";
        statusClass = "status-rejected";
      }

      rows+=`
      <tr class="${statusClass}">
        <td>${index+1}</td>
        <td>${item.fullname}</td>
        <td>${item.problem}</td>
        <td>${item.time}</td>
        <td>${displayStatus}</td>
      </tr>`;
    });
  }

  document.getElementById("app").innerHTML=`
  <div class="container">
    <div class="glass">
      <h2>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h2>
      <table>
        <tr>
          <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠</th>
          <th>‡∏õ‡∏±‡∏ç‡∏´‡∏≤</th>
          <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
          <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        </tr>
        ${rows}
      </table>
      <br>
      <button class="green" onclick="showForm()">‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</button>
      <button class="gray" onclick="showHome()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>
  </div>`;
}

// ---------- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á ----------
function showForm(){
  document.getElementById("app").innerHTML=`
  <div class="container">
    <div class="glass">
      <h2>‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h2>
      <input id="fullname" placeholder="‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
      <input id="classroom" placeholder="‡∏ä‡∏±‡πâ‡∏ô">
      <input id="email" type="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
      <textarea id="problem" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤"></textarea>
      <button class="blue" onclick="submitProblem()">‡∏™‡πà‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</button>
      <button class="gray" onclick="showUserDashboard()">‡∏Å‡∏•‡∏±‡∏ö</button>
    </div>
  </div>`;
}

function submitProblem(){
  let fullname=document.getElementById("fullname").value;
  let classroom=document.getElementById("classroom").value;
  let email=document.getElementById("email").value;
  let problem=document.getElementById("problem").value;

  if(!fullname || !classroom || !email || !problem){
    alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô");
    return;
  }

  let data=JSON.parse(localStorage.getItem("problems"))||[];

  let newItem={
    id:Date.now(),
    phone:currentUserPhone,
    fullname,
    classroom,
    email,
    problem,
    time:new Date().toLocaleString("th-TH"),
    status:""
  };

  data.push(newItem);
  localStorage.setItem("problems",JSON.stringify(data));
  showUserDashboard();
}

// ---------- ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ----------
function showAdminLogin(){
  document.getElementById("app").innerHTML=`
  <div class="container">
    <div class="glass">
      <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
      <input id="user" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
      <input id="pass" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
      <button class="blue" onclick="adminLogin()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      <button class="gray" onclick="showHome()">‡∏Å‡∏•‡∏±‡∏ö</button>
      <p id="err" style="color:red;"></p>
    </div>
  </div>`;
}

function adminLogin(){
  if(user.value===ADMIN_USERNAME && pass.value===ADMIN_PASSWORD){
    showAdminDashboard();
  }else{
    document.getElementById("err").innerText="‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
  }
}

function showAdminDashboard(){
  let data=JSON.parse(localStorage.getItem("problems"))||[];

  let rows="";

  if(data.length===0){
    rows=`<tr><td colspan="8">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
  }else{
    data.forEach((item,index)=>{
      rows+=`
      <tr>
        <td>${index+1}</td>
        <td>${item.phone}</td>
        <td>${item.fullname}</td>
        <td>${item.classroom}</td>
        <td>${item.email}</td>
        <td>${item.problem}</td>
        <td>${item.status||"‡∏£‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô"}</td>
        <td>
          <button class="green" onclick="updateStatus(${item.id},'‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°')">‚úî</button>
          <button class="red" onclick="updateStatus(${item.id},'‡πÑ‡∏°‡πà‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°')">‚úñ</button>
        </td>
      </tr>`;
    });
  }

  document.getElementById("app").innerHTML=`
  <div class="container">
    <div class="glass">
      <h2>‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
      <table>
        <tr>
          <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
          <th>‡πÄ‡∏ö‡∏≠‡∏£‡πå</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠</th>
          <th>‡∏ä‡∏±‡πâ‡∏ô</th>
          <th>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
          <th>‡∏õ‡∏±‡∏ç‡∏´‡∏≤</th>
          <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
          <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
        ${rows}
      </table>
      <br>
      <button class="gray" onclick="showHome()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>
  </div>`;
}

function updateStatus(id,status){
  let data=JSON.parse(localStorage.getItem("problems"));
  data=data.map(item=>{
    if(item.id===id){ item.status=status; }
    return item;
  });
  localStorage.setItem("problems",JSON.stringify(data));
  showAdminDashboard();
}

showHome();
</script>
